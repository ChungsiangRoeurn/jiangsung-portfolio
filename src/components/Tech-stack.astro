---
import type { TechStackItem } from "@types";
import Section from "./Section.astro";

interface Props {
  techStack: TechStackItem[];
}

const { techStack } = Astro.props;
---

<Section text="Tech Stack" href="tech-stack">
  <div class="max-w-6xl mx-auto">
    {
      techStack?.length ? (
        <div class="relative">
          <!-- Decorative background elements -->
          <div class="absolute top-0 left-1/4 w-64 h-64 bg-[#F5D0A9]/5 rounded-full blur-3xl"></div>
          <div class="absolute bottom-0 right-1/4 w-64 h-64 bg-[#F5D0A9]/5 rounded-full blur-3xl"></div>
          
          <ul class="relative flex flex-wrap justify-center gap-4 md:gap-6">
            {techStack.map(({ name, icon, url }, index) => (
              <li
                class="group relative opacity-0 translate-y-6 transition-all duration-700"
                data-scroll-animation
                style={`transition-delay: ${index * 0.05}s`}
              >
                <a 
                  href={url} 
                  target="_blank"
                  rel="noopener noreferrer"
                  class="relative flex flex-col items-center gap-3 p-6 rounded-2xl
                  bg-gradient-to-br from-gray-900/80 to-gray-800/80 backdrop-blur-sm
                  border border-[#F5D0A9]/20 
                  hover:border-[#F5D0A9]/50 
                  transition-all duration-300
                  hover:scale-110 hover:shadow-xl hover:shadow-[#F5D0A9]/20
                  hover:-translate-y-2
                  min-w-[120px] md:min-w-[140px]
                  overflow-hidden"
                >
                  <!-- Shine effect on hover -->
                  <div class="absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-500">
                    <div class="absolute inset-0 bg-gradient-to-br from-[#F5D0A9]/10 via-transparent to-transparent"></div>
                  </div>
                  
                  <!-- Icon container with glow effect -->
                  <div class="relative z-10 w-16 h-16 md:w-20 md:h-20 flex items-center justify-center
                    bg-gray-800/50 rounded-xl p-3
                    group-hover:bg-[#F5D0A9]/10
                    transition-all duration-300
                    group-hover:shadow-lg group-hover:shadow-[#F5D0A9]/30">
                    <img
                      src={icon}
                      alt={`${name} logo`}
                      class="w-full h-full object-contain
                      group-hover:scale-110 transition-transform duration-300
                      filter group-hover:drop-shadow-lg"
                    />
                  </div>
                  
                  <!-- Tech name -->
                  <span class="relative z-10 text-sm md:text-base font-semibold text-[#EDE6DA]
                    group-hover:text-[#F5D0A9] transition-colors duration-300
                    text-center">
                    {name}
                  </span>
                  
                  <!-- Hover indicator -->
                  <div class="absolute bottom-0 left-1/2 -translate-x-1/2 w-0 h-1 bg-gradient-to-r from-transparent via-[#F5D0A9] to-transparent
                    group-hover:w-full transition-all duration-300 rounded-full"></div>
                </a>
              </li>
            ))}
          </ul>
          
          <!-- Stats section -->
          <div class="mt-12 flex flex-wrap justify-center gap-6 md:gap-12">
            <div class="text-center p-6 rounded-xl bg-gray-900/50 border border-[#F5D0A9]/20 backdrop-blur-sm min-w-[140px]
              hover:border-[#F5D0A9]/40 transition-all duration-300 hover:shadow-lg hover:shadow-[#F5D0A9]/10">
              <div class="text-3xl md:text-4xl font-bold text-[#F5D0A9] mb-2">
                {techStack.length}+
              </div>
              <div class="text-sm md:text-base text-gray-400">Technologies</div>
            </div>
            
            <div class="text-center p-6 rounded-xl bg-gray-900/50 border border-[#F5D0A9]/20 backdrop-blur-sm min-w-[140px]
              hover:border-[#F5D0A9]/40 transition-all duration-300 hover:shadow-lg hover:shadow-[#F5D0A9]/10">
              <div class="text-3xl md:text-4xl font-bold text-[#F5D0A9] mb-2">
                âˆž
              </div>
              <div class="text-sm md:text-base text-gray-400">Learning</div>
            </div>
            
            <div class="text-center p-6 rounded-xl bg-gray-900/50 border border-[#F5D0A9]/20 backdrop-blur-sm min-w-[140px]
              hover:border-[#F5D0A9]/40 transition-all duration-300 hover:shadow-lg hover:shadow-[#F5D0A9]/10">
              <div class="text-3xl md:text-4xl font-bold text-[#F5D0A9] mb-2">
                ðŸ’¡
              </div>
              <div class="text-sm md:text-base text-gray-400">Innovation</div>
            </div>
          </div>
        </div>
      ) : (
        <div class="text-center p-12 rounded-xl bg-gray-900/50 border border-gray-700">
          <p class="text-gray-300 text-lg">No tech stack data available.</p>
        </div>
      )
    }
  </div>
</Section>

<style>
  @keyframes float {
    0%, 100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-10px);
    }
  }

  [data-scroll-animation]:hover {
    animation: float 2s ease-in-out infinite;
  }
</style>

<script>
  function setupScrollAnimations() {
    const animatedElements = document.querySelectorAll(
      "[data-scroll-animation]",
    );
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            const element = entry.target;
            if (element instanceof HTMLElement) {
              element.style.opacity = "1";
              element.style.transform = "translateY(0)";
            }
            observer.unobserve(entry.target);
          }
        });
      },
      {
        root: null,
        threshold: 0.1,
        rootMargin: "-50px",
      },
    );

    animatedElements.forEach((el) => observer.observe(el));
  }

  setupScrollAnimations();
  document.addEventListener("astro:page-load", setupScrollAnimations);
</script>